# Ветролов

Приложение помогает выбрать город для райда в выходные дни, анализируя погодные условия и предлагая оптимальные маршруты.

## Откуда берутся данные

*   **Погода**: Данные запрашиваются через Open-Meteo API. Используются параметры: температура (на 2м), осадки, вероятность осадков, скорость и направление ветра (на 10м), порывы ветра, ощущаемая температура, продолжительность солнечного сияния, а также температура на высотах 1000 и 1500 метров (900 и 850 гПа).
*   **Города**: Список доступных городов и их координаты зафиксированы в конфигурации приложения.
*   **Маршруты**: База GPX-треков хранится локально в приложении. Каждый трек маркирован по направлению (Север, Юг, и т.д.) для привязки к направлению ветра.
*   **Места**: Списки рекомендуемых мест (кафе, рестораны) заданы статически для каждого города.

## Анализ данных

Приложение автоматически анализирует погоду на ближайшие и следующие выходные, а также праздничные дни.

1.  **Оценка пригодности погоды**:
    *   Расчет суммарных осадков в активное время (с 09:00 до 18:00). День считается "сухим", если сумма осадков не превышает 0.5 мм.
    *   Анализ "запрещенных часов" (с 05:00 до 13:00) на предмет дождя для оценки влажности дорог перед стартом.
    *   Анализ температурного режима и силы ветра.

2.  **Подбор маршрута**:
    *   Для каждого города определяется преобладающее направление ветра.
    *   Алгоритм проверяет наличие маршрута, оптимизированного под это направление ветра (чтобы минимизировать встречный ветер).
    *   Если подходящий маршрут найден, рассчитывается его длина, профиль высоты и оценка сложности рельефа.
    *   Рассчитывается примерное время в пути (исходя из средней скорости 30 км/ч).

3.  **Рекомендации по экипировке**:
    Формируется детальный чек-лист одежды на основе анализа почасового прогноза в период планируемой поездки (09:00 — 18:00). Если максимальная температура ниже +5°C или ожидаются сильные дожди (> 0.5 мм), система не выдает рекомендаций.

    **Используемые данные Open Meteo API:**
    *   `temperature_2m` (Почасовая температура): Ключевой параметр. Вычисляются минимумы и максимумы за время поездки, а также сравниваются утренние (09:00-11:00) и дневные (11:00-18:00) значения для адаптивных советов (например, рукава и ногова).
    *   `wind_speed_10m` (Скорость ветра): Максимальные значения ветра определяют класс ветрозащиты (плотная куртка или легкая жилетка).
    *   `precipitation` (Осадки): Влияют на сам факт рекомендации райда.

    **Правила подбора одежды на райд:**
    *   **Джерси**:
        *   Ниже +8°C: Winter Jacket
        *   +8°C...+15°C: Long Sleeve Jersey Cold
        *   +15°C...+22°C: Long Sleeve Jersey Hot
        *   Выше +22°C: Jersey
    *   **Ноги**:
        *   Ниже +14°C: Bib Tights
        *   Выше +14°C: Bib Shorts
        *   +14°C...+19°C: Добавляются утеплители ног/коленей.
    *   **Верхний слой**:
        *   Назначается, если холодно (мин. < 12°C), ветрено (ветер > 15 км/ч) или прохладно (+10°C...+20°C).
        *   *Куртка (Jacket)*: При ветре ≥ 15 км/ч или в горных регионах.
        *   *Жилетка (Vest)*: В остальных случаях.
    *   **Аксессуары**:
        *   *Arm Warmers (Рукава)*: Предлагаются, если утром прохладно (< 16°C), а днем значительно теплеет (> 19°C). Это позволяет стартовать в тепле и раздеться по ходу маршрута.
        *   *Утепление ног*: Oversocks (при < 8°C) или Toe covers (при +8°C...+14°C).
        *   *Шея*: Buff рекомендуются при температуре ниже +8°C.

## Что получает пользователь

Пользователь получает инструмент для планирования выезда:

*   **Сводка по городам**: Список направлений с индикацией пригодности погоды (Сухо/Дождь) на субботу и воскресенье.
*   **Детальный прогноз**: Для каждого дня показаны температура, ощущаемая температура, скорость и порывы ветра, часы солнечного сияния.
*   **Оптимальный маршрут**: Предложение конкретного трека (GPX), который лучше всего подходит под текущий ветер.
*   **Параметры поездки**: Дистанция, набор высоты и расчетное время в пути.
*   **Чек-лист одежды**: Конкретный список вещей, которые нужно надеть, чтобы не замерзнуть и не перегреться.
*   **Инфраструктура**: Подборка мест (кафе/рестораны) в городе прибытия.

## Полезные функции интерфейса

*   **Настройка темпа**: Возможность изменять среднюю скорость (от 23 до 38 км/ч), при этом автоматически пересчитывается время в пути и скорость в выбранной точке (на профиле).
*   **Интерактивная карта и профиль**: Синхронизированный просмотр — при наведении курсора на график высоты на карте отображается точка маршрута и направление ветра в этом месте.
*   **Экспорт и шеринг**: Возможность скачать GPX-файл или сразу передать его в велокомпьютер (через нативное меню "Отправить" в мобильной версии).

## Технологии

*   **Frontend**: React, TypeScript, Vite
*   **Стили**: Tailwind CSS
*   **Карты**: MapLibre GL JS
*   **API**: Open-Meteo
